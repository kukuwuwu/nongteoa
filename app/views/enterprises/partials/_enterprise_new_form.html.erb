<h1>New enterprise</h1>

<%= form_for(@enterprise) do |f| %>
  <% if @enterprise.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@enterprise.errors.count, "error") %> prohibited this enterprise from being saved:</h2>

      <ul>
        <% @enterprise.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :admin_id %><br />
    <%= f.text_field :admin_id %>
  </div>
  <div class="field">
    <%= f.label :title %><br />
    <%= f.text_field :title %>
  </div>
  <div class="field">
    <%= f.label :industry_id %><br />
    <%= f.text_field :industry_id %>
  </div>
  <div class="field">
    <%= f.label :fax_num %><br />
    <%= f.text_field :fax_num %>
  </div>
  <div class="field">
    <%= f.label :phone_num %><br />
    <%= f.text_field :phone_num %>
  </div>
  <div class="field">
    <%= f.label :address %><br />
    <%= f.text_field :address %>
  </div>
  <div class="field">
    <%= f.label :zip_code %><br />
    <%= f.text_field :zip_code %>
  </div>
  <div class="field">
    <%= f.label :mail %><br />
    <%= f.text_field :mail %>
  </div>
  <div class="field">
    <%= f.label :site %><br />
    <%= f.text_field :site %>
  </div>
  <div class="field">
    <%= f.label :qq %><br />
    <%= f.text_field :qq %>
  </div>
  <div class="field">
    <%= f.label :remark %><br />
    <%= f.text_field :remark %>
  </div>
  <div class="field">
    <%= f.label :trademark %><br />
    <%= f.text_field :trademark %>
  </div>
  <div class="field">
    <%= f.label :product %><br />
    <%= f.text_area :product %>
  </div>
  <div class="field">
    <%= f.label :introduction %><br />
    <%= f.text_area :introduction %>
  </div>
  <div>
    <% @enterprise.content_persons.build %>
    <%=f.fields_for :content_persons do |content_person|%>
      <div>
        <%= content_person.label :name%><br />
        <%= content_person.text_field :name %>
      </div>
    <%end%>
    <%=f.fields_for :content_persons do |content_person|%>
      <div>
        <%= content_person.label :name%><br />
        <%= content_person.text_field :name %>
      </div>
    <%end%>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %>

<%= link_to 'Back', enterprises_path %>
<script type="text/javascript">
    var threeSelectData={
        "beijing":{val:"01",items:{
                "bj-01":{val:"0101",items:{
                        "bj-01-01":"010101"
                    }},
                "bj-02":{val:"0102",items:{
                        "bj-02-01":"010201",
                        "bj-02-02":"010202"
                    }}
            }},
        "shanxi":{val:"02",items:{}},
        "guangzhou":{val:"02",items:{}}
    };
    $(function(){
        var $s1=$("#Select1");
        var $s2=$("#Select2");
        var $s3=$("#Select3");
        // var v1=null;
        // var v2=null;
        // var v3=null;
        var v1="01";
        var v2="0102";
        var v3="010202";
        $.each(threeSelectData,function(k,v){
            appendOptionTo($s1,k,v.val,v1);
        });
        $s1.change(function(){
            $s2.html("");
            $s3.html("");
            if(this.selectedIndex==-1) return;
            var s1_curr_val = this.options[this.selectedIndex].value;
            $.each(threeSelectData,function(k,v){
                if(s1_curr_val==v.val){
                    if(v.items){
                        $.each(v.items,function(k,v){
                            appendOptionTo($s2,k,v.val,v2);
                        });
                    }
                }
            });
            $s2.change();
        }).change();
        $s2.change(function(){
            $s3.html("");
            var s1_curr_val = $s1[0].options[$s1[0].selectedIndex].value;
            if(this.selectedIndex==-1) return;
            var s2_curr_val = this.options[this.selectedIndex].value;
            $.each(threeSelectData,function(k,v){
                if(s1_curr_val==v.val){
                    if(v.items){
                        $.each(v.items,function(k,v){
                            if(s2_curr_val==v.val){
                                $.each(v.items,function(k,v){
                                    appendOptionTo($s3,k,v,v3);
                                });
                            }
                        });
                    }
                }
            });
        }).change();
        function appendOptionTo($o,k,v,d){
            var $opt=$("<option>").text(k).val(v);
            if(v==d){$opt.attr("selected", "selected")}
            $opt.appendTo($o);
        }
    });
</script>